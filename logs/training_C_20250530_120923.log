2025-05-30 12:09:23,475 [INFO] Starting training using datasets\C\train.json.gz
2025-05-30 12:10:08,719 [INFO] Loaded 3 pretrained models from model_paths_ABCD.txt
2025-05-30 12:10:08,722 [INFO] 
Starting cycle 1 with seed 1
2025-05-30 12:10:37,471 [INFO] 
Starting training cycle 1
2025-05-30 12:10:37,622 [INFO] Loaded pretrained model: checkpoints/model_ABCD_cycle_1_epoch_780_loss_0.713_f1_0.756.pth
2025-05-30 12:10:43,700 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_0_loss_2.540_f1_0.764.pth
2025-05-30 12:10:43,700 [INFO] Best validation metrics - Loss: 2.5399, F1: 0.7636
2025-05-30 12:10:49,343 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_1_loss_2.209_f1_0.774.pth
2025-05-30 12:10:49,347 [INFO] Best validation metrics - Loss: 2.2088, F1: 0.7743
2025-05-30 12:11:00,649 [INFO] Warm-up epochs finished
2025-05-30 12:11:34,751 [INFO] Cycle 1, Epoch 10, LR 5.000e-04, Train Loss: 2.5345, Val Loss: 2.2260, Val F1: 0.7636
2025-05-30 12:11:40,497 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_10_loss_2.037_f1_0.776.pth
2025-05-30 12:11:40,497 [INFO] Best validation metrics - Loss: 2.0367, F1: 0.7757
2025-05-30 12:12:09,098 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_15_loss_1.938_f1_0.783.pth
2025-05-30 12:12:09,098 [INFO] Best validation metrics - Loss: 1.9376, F1: 0.7833
2025-05-30 12:12:31,934 [INFO] Cycle 1, Epoch 20, LR 5.000e-04, Train Loss: 2.2080, Val Loss: 2.0634, Val F1: 0.7772
2025-05-30 12:12:43,406 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_21_loss_2.007_f1_0.784.pth
2025-05-30 12:12:43,407 [INFO] Best validation metrics - Loss: 2.0073, F1: 0.7839
2025-05-30 12:13:00,528 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_24_loss_1.928_f1_0.786.pth
2025-05-30 12:13:00,528 [INFO] Best validation metrics - Loss: 1.9279, F1: 0.7856
2025-05-30 12:13:28,780 [INFO] Cycle 1, Epoch 30, LR 5.000e-04, Train Loss: 2.1534, Val Loss: 2.4541, Val F1: 0.7224
2025-05-30 12:14:08,231 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_36_loss_1.837_f1_0.795.pth
2025-05-30 12:14:08,232 [INFO] Best validation metrics - Loss: 1.8367, F1: 0.7950
2025-05-30 12:14:25,283 [INFO] Cycle 1, Epoch 40, LR 3.500e-04, Train Loss: 1.8362, Val Loss: 1.8117, Val F1: 0.7944
2025-05-30 12:14:31,078 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_40_loss_1.738_f1_0.802.pth
2025-05-30 12:14:31,079 [INFO] Best validation metrics - Loss: 1.7383, F1: 0.8016
2025-05-30 12:14:42,430 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_42_loss_1.767_f1_0.803.pth
2025-05-30 12:14:42,431 [INFO] Best validation metrics - Loss: 1.7667, F1: 0.8030
2025-05-30 12:15:05,282 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_46_loss_1.735_f1_0.805.pth
2025-05-30 12:15:05,283 [INFO] Best validation metrics - Loss: 1.7350, F1: 0.8052
2025-05-30 12:15:22,275 [INFO] Cycle 1, Epoch 50, LR 3.500e-04, Train Loss: 1.7414, Val Loss: 1.8640, Val F1: 0.7890
2025-05-30 12:16:13,268 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_58_loss_1.650_f1_0.810.pth
2025-05-30 12:16:13,268 [INFO] Best validation metrics - Loss: 1.6503, F1: 0.8103
2025-05-30 12:16:18,983 [INFO] Cycle 1, Epoch 60, LR 2.450e-04, Train Loss: 1.6198, Val Loss: 1.6975, Val F1: 0.8144
2025-05-30 12:16:18,994 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_59_loss_1.697_f1_0.814.pth
2025-05-30 12:16:18,994 [INFO] Best validation metrics - Loss: 1.6975, F1: 0.8144
2025-05-30 12:16:24,794 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_60_loss_1.663_f1_0.815.pth
2025-05-30 12:16:24,794 [INFO] Best validation metrics - Loss: 1.6629, F1: 0.8149
2025-05-30 12:16:36,150 [INFO] New best model saved: checkpoints/model_C_cycle_1_epoch_62_loss_1.647_f1_0.820.pth
2025-05-30 12:16:36,150 [INFO] Best validation metrics - Loss: 1.6469, F1: 0.8198
2025-05-30 12:16:47,588 [INFO] Cycle 1 completed:
2025-05-30 12:16:47,589 [INFO] - Final validation loss: 1.6469
2025-05-30 12:16:47,589 [INFO] - Final F1 score: 0.8198
2025-05-30 12:16:47,590 [INFO] 
Starting cycle 2 with seed 2
2025-05-30 12:17:12,842 [INFO] 
Starting training cycle 2
2025-05-30 12:17:12,884 [INFO] Loaded pretrained model: checkpoints/model_ABCD_cycle_2_epoch_919_loss_0.697_f1_0.764.pth
2025-05-30 12:17:18,994 [INFO] New best model saved: checkpoints/model_C_cycle_2_epoch_0_loss_2.396_f1_0.770.pth
2025-05-30 12:17:18,995 [INFO] Best validation metrics - Loss: 2.3957, F1: 0.7703
2025-05-30 12:17:24,749 [INFO] New best model saved: checkpoints/model_C_cycle_2_epoch_1_loss_2.093_f1_0.783.pth
2025-05-30 12:17:24,749 [INFO] Best validation metrics - Loss: 2.0930, F1: 0.7828
2025-05-30 12:17:30,392 [INFO] New best model saved: checkpoints/model_C_cycle_2_epoch_2_loss_2.075_f1_0.785.pth
2025-05-30 12:17:30,393 [INFO] Best validation metrics - Loss: 2.0747, F1: 0.7854
2025-05-30 12:17:36,082 [INFO] Warm-up epochs finished
2025-05-30 12:18:09,646 [INFO] Cycle 2, Epoch 10, LR 5.000e-04, Train Loss: 2.4938, Val Loss: 2.3562, Val F1: 0.7287
2025-05-30 12:19:05,839 [INFO] Cycle 2, Epoch 20, LR 5.000e-04, Train Loss: 2.1504, Val Loss: 2.0081, Val F1: 0.7797
2025-05-30 12:19:11,588 [INFO] Reloading best model: checkpoints/model_C_cycle_2_epoch_2_loss_2.075_f1_0.785.pth
2025-05-30 12:19:56,439 [INFO] Early stopping triggered at epoch 28
2025-05-30 12:19:56,440 [INFO] Cycle 2 completed:
2025-05-30 12:19:56,440 [INFO] - Final validation loss: 2.0747
2025-05-30 12:19:56,440 [INFO] - Final F1 score: 0.7854
2025-05-30 12:19:56,441 [INFO] 
Starting cycle 3 with seed 3
2025-05-30 12:20:21,163 [INFO] 
Starting training cycle 3
2025-05-30 12:20:21,203 [INFO] Loaded pretrained model: checkpoints/model_ABCD_cycle_3_epoch_999_loss_0.677_f1_0.772.pth
2025-05-30 12:20:27,319 [INFO] New best model saved: checkpoints/model_C_cycle_3_epoch_0_loss_2.400_f1_0.772.pth
2025-05-30 12:20:27,319 [INFO] Best validation metrics - Loss: 2.3996, F1: 0.7724
2025-05-30 12:20:32,985 [INFO] New best model saved: checkpoints/model_C_cycle_3_epoch_1_loss_2.050_f1_0.794.pth
2025-05-30 12:20:32,986 [INFO] Best validation metrics - Loss: 2.0504, F1: 0.7945
2025-05-30 12:20:44,269 [INFO] Warm-up epochs finished
2025-05-30 12:21:18,035 [INFO] Cycle 3, Epoch 10, LR 5.000e-04, Train Loss: 2.4753, Val Loss: 2.5665, Val F1: 0.7072
2025-05-30 12:22:14,035 [INFO] Cycle 3, Epoch 20, LR 5.000e-04, Train Loss: 2.1587, Val Loss: 1.9551, Val F1: 0.7836
2025-05-30 12:22:19,685 [INFO] Reloading best model: checkpoints/model_C_cycle_3_epoch_1_loss_2.050_f1_0.794.pth
2025-05-30 12:22:58,844 [INFO] Early stopping triggered at epoch 27
2025-05-30 12:22:58,845 [INFO] Cycle 3 completed:
2025-05-30 12:22:58,845 [INFO] - Final validation loss: 2.0504
2025-05-30 12:22:58,845 [INFO] - Final F1 score: 0.7945
2025-05-30 12:22:58,846 [INFO] 
Starting cycle 4 with seed 4
2025-05-30 12:23:23,632 [INFO] 
Starting training cycle 4
2025-05-30 12:23:23,662 [INFO] Loaded pretrained model: checkpoints/model_ABCD_cycle_1_epoch_780_loss_0.713_f1_0.756.pth
2025-05-30 12:23:29,667 [INFO] New best model saved: checkpoints/model_C_cycle_4_epoch_0_loss_2.247_f1_0.782.pth
2025-05-30 12:23:29,667 [INFO] Best validation metrics - Loss: 2.2466, F1: 0.7818
2025-05-30 12:23:40,855 [INFO] New best model saved: checkpoints/model_C_cycle_4_epoch_2_loss_1.905_f1_0.792.pth
2025-05-30 12:23:40,856 [INFO] Best validation metrics - Loss: 1.9048, F1: 0.7923
2025-05-30 12:23:46,473 [INFO] Warm-up epochs finished
2025-05-30 12:24:20,033 [INFO] Cycle 4, Epoch 10, LR 5.000e-04, Train Loss: 2.5620, Val Loss: 2.6097, Val F1: 0.6762
2025-05-30 12:25:16,161 [INFO] Cycle 4, Epoch 20, LR 5.000e-04, Train Loss: 2.3059, Val Loss: 2.0509, Val F1: 0.7509
2025-05-30 12:25:21,799 [INFO] Reloading best model: checkpoints/model_C_cycle_4_epoch_2_loss_1.905_f1_0.792.pth
2025-05-30 12:26:06,579 [INFO] Early stopping triggered at epoch 28
2025-05-30 12:26:06,580 [INFO] Cycle 4 completed:
2025-05-30 12:26:06,580 [INFO] - Final validation loss: 1.9048
2025-05-30 12:26:06,580 [INFO] - Final F1 score: 0.7923
2025-05-30 12:26:06,581 [INFO] 
Starting cycle 5 with seed 5
2025-05-30 12:26:31,148 [INFO] 
Starting training cycle 5
2025-05-30 12:26:31,173 [INFO] Loaded pretrained model: checkpoints/model_ABCD_cycle_2_epoch_919_loss_0.697_f1_0.764.pth
2025-05-30 12:26:37,212 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_0_loss_2.327_f1_0.779.pth
2025-05-30 12:26:37,212 [INFO] Best validation metrics - Loss: 2.3272, F1: 0.7791
2025-05-30 12:26:42,844 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_1_loss_2.064_f1_0.784.pth
2025-05-30 12:26:42,845 [INFO] Best validation metrics - Loss: 2.0642, F1: 0.7840
2025-05-30 12:26:54,076 [INFO] Warm-up epochs finished
2025-05-30 12:27:27,434 [INFO] Cycle 5, Epoch 10, LR 5.000e-04, Train Loss: 2.5754, Val Loss: 2.0905, Val F1: 0.7684
2025-05-30 12:28:23,538 [INFO] Cycle 5, Epoch 20, LR 5.000e-04, Train Loss: 2.2130, Val Loss: 2.0838, Val F1: 0.7625
2025-05-30 12:28:29,160 [INFO] Reloading best model: checkpoints/model_C_cycle_5_epoch_1_loss_2.064_f1_0.784.pth
2025-05-30 12:29:08,346 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_27_loss_1.972_f1_0.786.pth
2025-05-30 12:29:08,346 [INFO] Best validation metrics - Loss: 1.9716, F1: 0.7863
2025-05-30 12:29:19,588 [INFO] Cycle 5, Epoch 30, LR 3.500e-04, Train Loss: 2.1220, Val Loss: 1.9914, Val F1: 0.7833
2025-05-30 12:30:15,428 [INFO] Cycle 5, Epoch 40, LR 2.450e-04, Train Loss: 1.7745, Val Loss: 1.7994, Val F1: 0.7916
2025-05-30 12:30:15,439 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_39_loss_1.799_f1_0.792.pth
2025-05-30 12:30:15,440 [INFO] Best validation metrics - Loss: 1.7994, F1: 0.7916
2025-05-30 12:30:32,272 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_42_loss_1.674_f1_0.807.pth
2025-05-30 12:30:32,273 [INFO] Best validation metrics - Loss: 1.6744, F1: 0.8067
2025-05-30 12:31:11,424 [INFO] Cycle 5, Epoch 50, LR 2.450e-04, Train Loss: 1.6486, Val Loss: 1.7853, Val F1: 0.7930
2025-05-30 12:31:28,246 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_52_loss_1.750_f1_0.807.pth
2025-05-30 12:31:28,246 [INFO] Best validation metrics - Loss: 1.7499, F1: 0.8070
2025-05-30 12:31:50,703 [INFO] New best model saved: checkpoints/model_C_cycle_5_epoch_56_loss_1.627_f1_0.813.pth
2025-05-30 12:31:50,704 [INFO] Best validation metrics - Loss: 1.6270, F1: 0.8133
2025-05-30 12:32:07,537 [INFO] Cycle 5, Epoch 60, LR 2.450e-04, Train Loss: 1.6022, Val Loss: 1.7934, Val F1: 0.7898
2025-05-30 12:32:35,466 [INFO] Cycle 5 completed:
2025-05-30 12:32:35,466 [INFO] - Final validation loss: 1.6270
2025-05-30 12:32:35,466 [INFO] - Final F1 score: 0.8133
2025-05-30 12:32:35,467 [INFO] Saved paths of the best models to model_paths_C.txt
2025-05-30 12:32:35,500 [INFO] Generating predictions for datasets\C\test.json.gz
2025-05-30 12:32:51,622 [INFO] Model weights for ensemble:
2025-05-30 12:32:51,623 [INFO] Model: model_C_cycle_1_epoch_62_loss_1.647_f1_0.820.pth
2025-05-30 12:32:51,623 [INFO] - Loss: 0.8198
2025-05-30 12:32:51,623 [INFO] - Weight: 0.2038
2025-05-30 12:32:51,623 [INFO] Model: model_C_cycle_2_epoch_2_loss_2.075_f1_0.785.pth
2025-05-30 12:32:51,624 [INFO] - Loss: 0.7854
2025-05-30 12:32:51,624 [INFO] - Weight: 0.1969
2025-05-30 12:32:51,624 [INFO] Model: model_C_cycle_3_epoch_1_loss_2.050_f1_0.794.pth
2025-05-30 12:32:51,624 [INFO] - Loss: 0.7945
2025-05-30 12:32:51,624 [INFO] - Weight: 0.1987
2025-05-30 12:32:51,624 [INFO] Model: model_C_cycle_4_epoch_2_loss_1.905_f1_0.792.pth
2025-05-30 12:32:51,625 [INFO] - Loss: 0.7923
2025-05-30 12:32:51,625 [INFO] - Weight: 0.1982
2025-05-30 12:32:51,625 [INFO] Model: model_C_cycle_5_epoch_56_loss_1.627_f1_0.813.pth
2025-05-30 12:32:51,625 [INFO] - Loss: 0.8133
2025-05-30 12:32:51,625 [INFO] - Weight: 0.2024
2025-05-30 12:32:51,629 [INFO] 
Ensemble prediction statistics:
2025-05-30 12:32:51,629 [INFO] Class 0: 91 samples
2025-05-30 12:32:51,629 [INFO] Class 1: 246 samples
2025-05-30 12:32:51,630 [INFO] Class 2: 906 samples
2025-05-30 12:32:51,630 [INFO] Class 3: 89 samples
2025-05-30 12:32:51,630 [INFO] Class 4: 92 samples
2025-05-30 12:32:51,630 [INFO] Class 5: 106 samples
2025-05-30 12:32:51,631 [INFO] Average confidence: 0.9381
2025-05-30 12:32:51,631 [INFO] Min confidence: 0.3951
2025-05-30 12:32:51,631 [INFO] Max confidence: 1.0000
2025-05-30 12:32:51,640 [INFO] Saved predictions to submission/testset_C.csv
